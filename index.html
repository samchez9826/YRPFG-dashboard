<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰¬å­æ±Ÿè¯ä¸šé›†å›¢ å·¡è§†é©¾é©¶èˆ±</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'PingFang SC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        /* å¤´éƒ¨åŒºåŸŸ */
        .header {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255,255,255,0.2);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 30px rgba(0,0,0,0.1);
            padding: 20px 0;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo-section {
            display: flex;
            align-items: center;
        }

        .company-logo {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
            margin-right: 15px;
        }

        .header-text h1 {
            font-size: 1.8rem;
            color: #2d3748;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .header-text p {
            color: #718096;
            font-size: 0.9rem;
        }

        .header-status {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .status-badge {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        /* å®¹å™¨ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* å·¡è§†å·¥ä½œè¿›åº¦çªå‡ºå±•ç¤ºåŒº */
        .progress-highlight {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 2px solid rgba(222, 226, 230, 0.8);
        }

        .progress-title {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 25px;
        }

        .progress-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }

        .progress-stat {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 2px solid;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .progress-stat.completed {
            border-color: #28a745;
        }

        .progress-stat.total {
            border-color: #0366d6;
        }

        .progress-stat.percentage {
            border-color: #fd7e14;
        }

        .progress-stat.issues {
            border-color: #dc3545;
        }

        .stat-label {
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .completed .stat-value { color: #28a745; }
        .total .stat-value { color: #0366d6; }
        .percentage .stat-value { color: #fd7e14; }
        .issues .stat-value { color: #dc3545; }

        .stat-detail {
            font-size: 0.8rem;
            color: #6c757d;
        }

        /* è¿›åº¦æ¡å¯è§†åŒ– */
        .progress-visual {
            margin-top: 20px;
        }

        .progress-visual h3 {
            font-size: 1.1rem;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 15px;
        }

        .progress-bar-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e1e4e8;
        }

        .progress-bar-bg {
            width: 100%;
            height: 25px;
            background: #e9ecef;
            border-radius: 12px;
            position: relative;
            margin-bottom: 15px;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            border-radius: 12px;
            width: 66.7%;
            position: relative;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.9rem;
            font-weight: bold;
            color: #2d3748;
        }

        .progress-labels {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .progress-label {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
        }

        .label-normal { background: #28a745; }
        .label-target { background: #0366d6; }

        /* æ ¸å¿ƒé£é™©æŒ‡æ ‡æ€»è§ˆåŒº */
        .risk-overview {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 20px;
        }

        .risk-cards {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
        }

        .risk-card {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .risk-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
        }

        .risk-card.high-risk::before {
            background: linear-gradient(90deg, #dc3545, #c82333);
        }

        .risk-card.medium-risk::before {
            background: linear-gradient(90deg, #fd7e14, #e55100);
        }

        .risk-card.low-risk::before {
            background: linear-gradient(90deg, #28a745, #20c997);
        }

        .risk-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .risk-title {
            font-size: 1rem;
            font-weight: bold;
            color: #2d3748;
        }

        .risk-level {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
        }

        .risk-level.high { background: #dc3545; }
        .risk-level.medium { background: #fd7e14; }
        .risk-level.low { background: #28a745; }

        .risk-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .high-risk .risk-value { color: #dc3545; }
        .medium-risk .risk-value { color: #fd7e14; }
        .low-risk .risk-value { color: #28a745; }

        .risk-details {
            font-size: 0.85rem;
            color: #6c757d;
            line-height: 1.4;
        }

        .risk-highlight {
            font-size: 0.8rem;
            margin-top: 8px;
            font-weight: 500;
        }

        .high-risk .risk-highlight { color: #dc3545; }
        .medium-risk .risk-highlight { color: #fd7e14; }
        .low-risk .risk-highlight { color: #28a745; }

        /* é—®é¢˜åˆ†çº§ä¸åˆ†å¸ƒåŒº */
        .issue-classification {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .issue-levels {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .issue-level {
            display: flex;
            align-items: flex-start;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 4px solid;
        }

        .issue-level.level-a { border-left-color: #dc3545; }
        .issue-level.level-b { border-left-color: #fd7e14; }
        .issue-level.level-c { border-left-color: #ffc107; }

        .issue-indicator {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            margin-right: 15px;
            margin-top: 2px;
        }

        .level-a .issue-indicator { background: #dc3545; }
        .level-b .issue-indicator { background: #fd7e14; }
        .level-c .issue-indicator { background: #ffc107; }

        .issue-content {
            flex: 1;
        }

        .issue-header {
            font-size: 1rem;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .issue-examples {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 8px;
        }

        .issue-description {
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .level-a .issue-description { color: #dc3545; }
        .level-b .issue-description { color: #fd7e14; }
        .level-c .issue-description { color: #e67e22; }

        /* å„åŒºåŸŸé£é™©çƒ­åŠ›å›¾ */
        .regional-heatmap {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .heatmap-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .heatmap-table th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 12px;
            font-weight: 600;
            text-align: center;
            font-size: 0.9rem;
        }

        .heatmap-table td {
            padding: 15px 12px;
            border-bottom: 1px solid #f1f5f9;
            font-size: 0.85rem;
            text-align: center;
        }

        .heatmap-table tr:hover {
            background: #f8fafc;
        }

        .region-name {
            text-align: left !important;
            font-weight: 600;
            color: #2d3748;
        }

        .risk-badge {
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
            display: inline-block;
            min-width: 60px;
        }

        .risk-high { background: #dc3545; }
        .risk-medium { background: #fd7e14; }
        .risk-low { background: #28a745; }

        .risk-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
        }

        .indicator-high { background: #dc3545; }
        .indicator-medium { background: #fd7e14; }
        .indicator-low { background: #28a745; }

        .issue-detail {
            text-align: left !important;
            font-size: 0.8rem;
            color: #2d3748;
            line-height: 1.3;
        }

        .status-text {
            font-size: 0.85rem;
        }

        .status-good { color: #28a745; }
        .status-warning { color: #fd7e14; }
        .status-danger { color: #dc3545; }

        .action-link {
            color: #0366d6;
            text-decoration: underline;
            cursor: pointer;
            font-size: 0.85rem;
        }

        .action-link:hover {
            color: #0256cc;
        }

        /* å¿«é€Ÿæ“ä½œåŒº */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .action-btn {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border: none;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.9rem;
            font-weight: 600;
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .action-btn.primary { background: linear-gradient(135deg, #0366d6, #0256cc); }
        .action-btn.success { background: linear-gradient(135deg, #28a745, #20c997); }
        .action-btn.warning { background: linear-gradient(135deg, #fd7e14, #e55100); }
        .action-btn.secondary { background: linear-gradient(135deg, #6c757d, #5a6268); }
        .action-btn.info { background: linear-gradient(135deg, #17a2b8, #138496); }

        /* é‡è¦æé†’ */
        .important-reminders {
            background: rgba(255, 243, 205, 0.95);
            backdrop-filter: blur(20px);
            border: 2px solid #ffeaa7;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .reminder-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #856404;
            margin-bottom: 15px;
        }

        .reminder-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .reminder-item {
            font-size: 0.9rem;
            color: #856404;
            line-height: 1.4;
            position: relative;
            padding-left: 15px;
        }

        .reminder-item::before {
            content: 'â€¢';
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        /* åº•éƒ¨ä¿¡æ¯æ  */
        .footer {
            background: #2d3748;
            color: white;
            padding: 20px 0;
            text-align: center;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .footer-info {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .progress-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            .risk-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            .quick-actions {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            .header-content {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
            .progress-stats,
            .risk-cards,
            .quick-actions {
                grid-template-columns: 1fr;
            }
            .reminder-list {
                grid-template-columns: 1fr;
            }
            .footer-content {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .progress-highlight,
        .risk-card,
        .issue-classification,
        .regional-heatmap,
        .important-reminders {
            animation: fadeInUp 0.6s ease-out;
        }

        .risk-card:nth-child(2) { animation-delay: 0.1s; }
        .risk-card:nth-child(3) { animation-delay: 0.2s; }
        .risk-card:nth-child(4) { animation-delay: 0.3s; }
    </style>
</head>
<body>
    <!-- å¤´éƒ¨æ ‡é¢˜åŒº -->
    <div class="header">
        <div class="header-content">
            <div class="logo-section">
                <div class="company-logo">æ‰¬</div>
                <div class="header-text">
                    <h1>æ‰¬å­æ±Ÿè¯ä¸šé›†å›¢ å·¡è§†é©¾é©¶èˆ±</h1>
                    <p>2025å¹´9æœˆ | ç»è¥æ€»å…¬å¸å·¡è§†ç»„ | æœ€åæ›´æ–°ï¼š09-28 14:30</p>
                </div>
            </div>
            <div class="header-status">
                <div class="status-badge">æ€»ä½“å¥åº·åº¦ï¼šè‰¯å¥½</div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- å·¡è§†å·¥ä½œè¿›åº¦çªå‡ºå±•ç¤ºåŒº -->
        <div class="progress-highlight">
            <div class="progress-title">2025å¹´åº¦å·¡è§†å·¥ä½œè¿›åº¦</div>
            
            <div class="progress-stats">
                <div class="progress-stat completed">
                    <div class="stat-label">å·²å®Œæˆå·¡è§†</div>
                    <div class="stat-value">8å®¶</div>
                    <div class="stat-detail">è¾½å®ã€å±±è¥¿ã€æµ™æ±Ÿã€æ–°ç–†ã€åŒ—äº¬ã€å±±ä¸œã€æˆéƒ½ã€å¹¿å·</div>
                </div>
                
                <div class="progress-stat total">
                    <div class="stat-label">å¹´åº¦è®¡åˆ’æ€»æ•°</div>
                    <div class="stat-value">12å®¶</div>
                    <div class="stat-detail">å«çœå…¬å¸ã€åŒºåŸŸã€ä¸“é¡¹</div>
                </div>
                
                <div class="progress-stat percentage">
                    <div class="stat-label">å®Œæˆè¿›åº¦</div>
                    <div class="stat-value">66.7%</div>
                    <div class="stat-detail">è¶…è¿‡Q3è®¡åˆ’25%</div>
                </div>
                
                <div class="progress-stat issues">
                    <div class="stat-label">å‘ç°é—®é¢˜</div>
                    <div class="stat-value">17é¡¹</div>
                    <div class="stat-detail">Açº§3é¡¹ Bçº§6é¡¹ Cçº§8é¡¹</div>
                </div>
            </div>

            <div class="progress-visual">
                <h3>å·¡è§†è¦†ç›–è¿›åº¦å¯è§†åŒ–</h3>
                <div class="progress-bar-container">
                    <div class="progress-bar-bg">
                        <div class="progress-bar-fill">
                            <div class="progress-text">8/12 å®¶å•ä½å·²å®Œæˆ (66.7%)</div>
                        </div>
                    </div>
                    <div class="progress-labels">
                        <div class="progress-label label-normal">è¿›åº¦æ­£å¸¸</div>
                        <div class="progress-label label-target">Q4ç›®æ ‡8å®¶</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ ¸å¿ƒé£é™©æŒ‡æ ‡æ€»è§ˆåŒº -->
        <div class="risk-overview">
            <h2 class="section-title">æ ¸å¿ƒé£é™©æŒ‡æ ‡æ€»è§ˆ</h2>
            
            <div class="risk-cards">
                <!-- äººå‘˜é£é™©å¡ç‰‡ -->
                <div class="risk-card high-risk">
                    <div class="risk-header">
                        <div class="risk-title">äººå‘˜é£é™©</div>
                        <div class="risk-level high">é«˜é£é™©</div>
                    </div>
                    <div class="risk-value">87äºº</div>
                    <div class="risk-details">
                        æ€»ç¼ºå£ | æ±°æ¢ç‡æœ€é«˜94%
                    </div>
                    <div class="risk-highlight">å±±è¥¿ç¼ºå£æœ€ä¸¥é‡(47äºº)</div>
                </div>

                <!-- è´¢åŠ¡é£é™©å¡ç‰‡ -->
                <div class="risk-card high-risk">
                    <div class="risk-header">
                        <div class="risk-title">è´¢åŠ¡é£é™©</div>
                        <div class="risk-level high">é«˜é£é™©</div>
                    </div>
                    <div class="risk-value">930ä¸‡</div>
                    <div class="risk-details">
                        å•†ä¸šå·®é¢ | è¿‘æ•ˆæœŸåº“å­˜
                    </div>
                    <div class="risk-highlight">å±±è¥¿å·®é¢æœ€å¤§(930ä¸‡)</div>
                </div>

                <!-- åˆè§„é£é™©å¡ç‰‡ -->
                <div class="risk-card medium-risk">
                    <div class="risk-header">
                        <div class="risk-title">åˆè§„é£é™©</div>
                        <div class="risk-level medium">ä¸­é£é™©</div>
                    </div>
                    <div class="risk-value">165ä¸‡</div>
                    <div class="risk-details">
                        èµ„é‡‘å›æµ | åˆ¶åº¦ç¼ºé™·
                    </div>
                    <div class="risk-highlight">CSOè½¬å‹åŸºæœ¬å®Œæˆ</div>
                </div>

                <!-- æ•´æ”¹è¿›åº¦å¡ç‰‡ -->
                <div class="risk-card low-risk">
                    <div class="risk-header">
                        <div class="risk-title">æ•´æ”¹è¿›åº¦</div>
                        <div class="risk-level low">æ­£å¸¸</div>
                    </div>
                    <div class="risk-value">68%</div>
                    <div class="risk-details">
                        å®Œæˆç‡ | 17é¡¹é—®é¢˜
                    </div>
                    <div class="risk-highlight">11é¡¹å·²å®Œæˆæ•´æ”¹</div>
                </div>
            </div>
        </div>

        <!-- é—®é¢˜åˆ†çº§ä¸åˆ†å¸ƒ -->
        <div class="issue-classification">
            <h2 class="section-title">é—®é¢˜åˆ†çº§ä¸åˆ†å¸ƒ</h2>
            
            <div class="issue-levels">
                <div class="issue-level level-a">
                    <div class="issue-indicator"></div>
                    <div class="issue-content">
                        <div class="issue-header">Açº§é¢„è­¦ (3é¡¹)</div>
                        <div class="issue-examples">å•†ä¸šå·®é¢930ä¸‡ | äººå‘˜æ±°æ¢ç‡94% | èµ„é‡‘å›æµé—®é¢˜</div>
                        <div class="issue-description">éœ€ç«‹å³å¤„ç†çš„é«˜é£é™©é—®é¢˜ï¼Œå»ºè®®ç«‹å³ä¸ŠæŠ¥é›†å›¢</div>
                    </div>
                </div>

                <div class="issue-level level-b">
                    <div class="issue-indicator"></div>
                    <div class="issue-content">
                        <div class="issue-header">Bçº§ç›‘æ§ (6é¡¹)</div>
                        <div class="issue-examples">è¿‘æ•ˆæœŸåº“å­˜ | äººå‘˜ç¼ºå£87äºº | ç§‘ç ”é¡¹ç›®æ»å | åˆ¶åº¦ä½“ç³»</div>
                        <div class="issue-description">é‡ç‚¹è·Ÿè¸ªçš„ä¸­ç­‰é£é™©é—®é¢˜ï¼Œéœ€åˆ¶å®šæ•´æ”¹è®¡åˆ’</div>
                    </div>
                </div>

                <div class="issue-level level-c">
                    <div class="issue-indicator"></div>
                    <div class="issue-content">
                        <div class="issue-header">Cçº§å…³æ³¨ (8é¡¹)</div>
                        <div class="issue-examples">ä¼šè®®å®æ•ˆæ€§ | HCPç­¾çº¦ç‡ | åŸ¹è®­ä½“ç³» | ä¸šåŠ¡å·¥å…·å®Œå–„</div>
                        <div class="issue-description">æ—¥å¸¸ç›‘æ§çš„ä¸€èˆ¬æ€§é—®é¢˜ï¼ŒæŒç»­æ”¹è¿›æå‡</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å„åŒºåŸŸé£é™©çƒ­åŠ›å›¾ -->
        <div class="regional-heatmap">
            <h2 class="section-title">å„åŒºåŸŸé£é™©çƒ­åŠ›å›¾</h2>
            
            <table class="heatmap-table">
                <thead>
                    <tr>
                        <th>åŒºåŸŸ</th>
                        <th>ç»¼åˆé£é™©</th>
                        <th>äººå‘˜</th>
                        <th>è´¢åŠ¡</th>
                        <th>åˆè§„</th>
                        <th>ä¸»è¦é—®é¢˜</th>
                        <th>æ•´æ”¹çŠ¶æ€</th>
                        <th>è´Ÿè´£äºº</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="region-name">è¾½å®æµ·æ‚¦</td>
                        <td><span class="risk-badge risk-medium">ä¸­é£é™©</span></td>
                        <td><span class="risk-indicator indicator-medium"></span></td>
                        <td><span class="risk-indicator indicator-low"></span></td>
                        <td><span class="risk-indicator indicator-low"></span></td>
                        <td class="issue-detail">æ±°æ¢ç‡94% | åˆ¶åº¦å»ºè®¾5é¡¹<br>å­¦æœ¯æ´»åŠ¨351åœº</td>
                        <td class="status-text status-good">5/7å·²å®Œæˆ</td>
                        <td>å¼ æ€»</td>
                        <td><span class="action-link">æŸ¥çœ‹è¯¦æƒ…</span></td>
                    </tr>
                    <tr>
                        <td class="region-name">å±±è¥¿æ™‹äº‘</td>
                        <td><span class="risk-badge risk-high">é«˜é£é™©</span></td>
                        <td><span class="risk-indicator indicator-high"></span></td>
                        <td><span class="risk-indicator indicator-high"></span></td>
                        <td><span class="risk-indicator indicator-medium"></span></td>
                        <td class="issue-detail">ç¼ºå£47äºº | å·®é¢930ä¸‡<br>æ±°æ¢ç‡94% | åˆ¶åº¦é—®é¢˜4é¡¹</td>
                        <td class="status-text status-danger">1/7å¾…æ•´æ”¹</td>
                        <td>ç‹æ€»</td>
                        <td><span class="action-link">æŸ¥çœ‹è¯¦æƒ…</span></td>
                    </tr>
                    <tr>
                        <td class="region-name">æµ™æ±Ÿæµ·æ½®</td>
                        <td><span class="risk-badge risk-medium">ä¸­é£é™©</span></td>
                        <td><span class="risk-indicator indicator-medium"></span></td>
                        <td><span class="risk-indicator indicator-low"></span></td>
                        <td><span class="risk-indicator indicator-low"></span></td>
                        <td class="issue-detail">ç¼ºå£34äºº | æ±°æ¢ç‡92%<br>å­¦æœ¯æ´»åŠ¨164åœº</td>
                        <td class="status-text status-warning">2/7æ•´æ”¹ä¸­</td>
                        <td>ææ€»</td>
                        <td><span class="action-link">æŸ¥çœ‹è¯¦æƒ…</span></td>
                    </tr>
                    <tr>
                        <td class="region-name">æ–°ç–†å…¬å¸</td>
                        <td><span class="risk-badge risk-low">ä½é£é™©</span></td>
                        <td><span class="risk-indicator indicator-low"></span></td>
                        <td><span class="risk-indicator indicator-low"></span></td>
                        <td><span class="risk-indicator indicator-low"></span></td>
                        <td class="issue-detail">ç¼ºå£5äºº | æ±°æ¢ç‡64%<br>å­¦æœ¯æ´»åŠ¨33åœº</td>
                        <td class="status-text status-good">3/4å·²å®Œæˆ</td>
                        <td>é™ˆæ€»</td>
                        <td><span class="action-link">æŸ¥çœ‹è¯¦æƒ…</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- å¿«é€Ÿæ“ä½œåŒº -->
        <div class="quick-actions">
            <button class="action-btn primary">ç”Ÿæˆæœˆåº¦æŠ¥å‘Š</button>
            <button class="action-btn success">å¯¼å‡ºé—®é¢˜æ¸…å•</button>
            <button class="action-btn warning">é¢„è­¦é€šçŸ¥è®¾ç½®</button>
            <button class="action-btn secondary">æŸ¥çœ‹å†å²è¶‹åŠ¿</button>
            <button class="action-btn info">å·¡è§†è®¡åˆ’ç®¡ç†</button>
        </div>

        <!-- é‡è¦æé†’ -->
        <div class="important-reminders">
            <div class="reminder-title">æœ¬æœˆé‡è¦æé†’</div>
            <div class="reminder-list">
                <div class="reminder-item">å±±è¥¿æ™‹äº‘äººå‘˜ç¼ºå£ä¸¥é‡ï¼Œå»ºè®®ç«‹å³å¯åŠ¨ç´§æ€¥æ‹›è˜ç¨‹åº</div>
                <div class="reminder-item">å•†ä¸šå·®é¢930ä¸‡éœ€åœ¨æœ¬æœˆåº•å‰å¤„ç†å®Œæ¯•ï¼Œé¿å…å½±å“å­£åº¦ç»“ç®—</div>
                <div class="reminder-item">å„åŒºåŸŸæ±°æ¢ç‡è¿‡é«˜éœ€å…³æ³¨ï¼Œå»ºè®®ä¼˜åŒ–äººå‘˜ç®¡ç†ç­–ç•¥</div>
                <div class="reminder-item">CSOè½¬å‹å·¥ä½œåŸºæœ¬å®Œæˆï¼Œéœ€è·Ÿè¿›åç»­ç®¡ç†æªæ–½</div>
            </div>
        </div>
    </div>

    <!-- åº•éƒ¨ä¿¡æ¯æ  -->
    <div class="footer">
        <div class="footer-content">
            <div class="footer-info">æ•°æ®æ¥æºï¼šå·¡è§†ç»„å®åœ°æ£€æŸ¥ | æ•°æ®èŒƒå›´ï¼šè¾½å®ã€å±±è¥¿ã€æµ™æ±Ÿã€æ–°ç–†å››ä¸ªåŒºåŸŸ</div>
            <div class="footer-info">æŠ€æœ¯æ”¯æŒï¼šå·¡è§†ç»„å´å¿—è¿œ | è”ç³»ç”µè¯ï¼š15618356048</div>
        </div>
    </div>

    <!-- æ¨¡æ€æ¡†æ ·å¼ -->
    <style>
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            margin: 5% auto;
            padding: 0;
            border-radius: 20px;
            width: 90%;
            max-width: 1000px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px 30px;
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .close {
            color: white;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: opacity 0.3s;
        }

        .close:hover {
            opacity: 0.7;
        }

        .modal-body {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2d3748;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 0.9rem;
            transition: border-color 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-right: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .data-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2d3748;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        .file-upload {
            border: 2px dashed #e2e8f0;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .file-upload:hover {
            border-color: #667eea;
        }

        .file-upload.dragover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            z-index: 1001;
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .gantt-chart {
            margin-top: 20px;
        }

        .gantt-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .gantt-label {
            width: 200px;
            font-weight: 600;
        }

        .gantt-bar {
            flex: 1;
            height: 20px;
            background: #e2e8f0;
            border-radius: 10px;
            position: relative;
            margin: 0 20px;
        }

        .gantt-progress {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            border-radius: 10px;
            transition: width 0.3s;
        }

        .gantt-date {
            width: 100px;
            text-align: right;
            font-size: 0.9rem;
            color: #6c757d;
        }
    </style>

    <script>
        // å…¨å±€æ•°æ®
        const dashboardData = {
            // å·¡è§†è®¡åˆ’æ•°æ®
            inspectionPlans: [
                { id: 1, name: 'è¾½å®æµ·æ‚¦å·¡è§†', startDate: '2025-09-01', endDate: '2025-09-15', progress: 100, status: 'å·²å®Œæˆ', responsible: 'å¼ æ€»' },
                { id: 2, name: 'å±±è¥¿æ™‹äº‘å·¡è§†', startDate: '2025-09-16', endDate: '2025-09-30', progress: 85, status: 'è¿›è¡Œä¸­', responsible: 'ç‹æ€»' },
                { id: 3, name: 'æµ™æ±Ÿæµ·æ½®å·¡è§†', startDate: '2025-10-01', endDate: '2025-10-15', progress: 0, status: 'æœªå¼€å§‹', responsible: 'ææ€»' },
                { id: 4, name: 'æ–°ç–†å…¬å¸å·¡è§†', startDate: '2025-10-16', endDate: '2025-10-30', progress: 0, status: 'æœªå¼€å§‹', responsible: 'é™ˆæ€»' }
            ],
            // é¢„è­¦è®¾ç½®
            alertSettings: {
                financialThreshold: 500, // ä¸‡å…ƒ
                personnelTurnoverThreshold: 90, // ç™¾åˆ†æ¯”
                complianceThreshold: 100 // ä¸‡å…ƒ
            },
            // é—®é¢˜æ¸…å•æ•°æ®
            issueList: [
                { id: 1, level: 'A', region: 'å±±è¥¿æ™‹äº‘', issue: 'å•†ä¸šå·®é¢930ä¸‡', status: 'å¾…å¤„ç†', responsible: 'ç‹æ€»', deadline: '2025-09-30' },
                { id: 2, level: 'A', region: 'å±±è¥¿æ™‹äº‘', issue: 'äººå‘˜ç¼ºå£47äºº', status: 'å¤„ç†ä¸­', responsible: 'ç‹æ€»', deadline: '2025-10-15' },
                { id: 3, level: 'A', region: 'è¾½å®æµ·æ‚¦', issue: 'æ±°æ¢ç‡94%', status: 'å¾…å¤„ç†', responsible: 'å¼ æ€»', deadline: '2025-10-01' },
                { id: 4, level: 'B', region: 'æµ™æ±Ÿæµ·æ½®', issue: 'äººå‘˜ç¼ºå£34äºº', status: 'å¤„ç†ä¸­', responsible: 'ææ€»', deadline: '2025-10-20' },
                { id: 5, level: 'B', region: 'è¾½å®æµ·æ‚¦', issue: 'åˆ¶åº¦å»ºè®¾æ»å', status: 'å¾…å¤„ç†', responsible: 'å¼ æ€»', deadline: '2025-10-10' },
                { id: 6, level: 'C', region: 'æ–°ç–†å…¬å¸', issue: 'åŸ¹è®­ä½“ç³»ä¸å®Œå–„', status: 'å¾…å¤„ç†', responsible: 'é™ˆæ€»', deadline: '2025-11-01' }
            ]
        };

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 8px; height: 8px; border-radius: 50%; background: ${type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#667eea'};"></div>
                    <span>${message}</span>
                </div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // ç”Ÿæˆæœˆåº¦æŠ¥å‘Š
        function generateMonthlyReport() {
            const modal = createModal('ç”Ÿæˆæœˆåº¦æŠ¥å‘Š', `
                <div class="form-group">
                    <label class="form-label">æŠ¥å‘Šæœˆä»½</label>
                    <select class="form-control" id="reportMonth">
                        <option value="2025-09">2025å¹´9æœˆ</option>
                        <option value="2025-08">2025å¹´8æœˆ</option>
                        <option value="2025-07">2025å¹´7æœˆ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">æŠ¥å‘Šç±»å‹</label>
                    <select class="form-control" id="reportType">
                        <option value="summary">ç»¼åˆæŠ¥å‘Š</option>
                        <option value="risk">é£é™©ä¸“é¡¹æŠ¥å‘Š</option>
                        <option value="personnel">äººå‘˜ä¸“é¡¹æŠ¥å‘Š</option>
                        <option value="finance">è´¢åŠ¡ä¸“é¡¹æŠ¥å‘Š</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">åŒ…å«å†…å®¹</label>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                        <label><input type="checkbox" checked> å·¡è§†è¿›åº¦æ¦‚è§ˆ</label>
                        <label><input type="checkbox" checked> é£é™©æŒ‡æ ‡åˆ†æ</label>
                        <label><input type="checkbox" checked> é—®é¢˜åˆ†çº§ç»Ÿè®¡</label>
                        <label><input type="checkbox" checked> åŒºåŸŸå¯¹æ¯”åˆ†æ</label>
                        <label><input type="checkbox" checked> æ•´æ”¹å»ºè®®</label>
                        <label><input type="checkbox" checked> ä¸‹æœˆè®¡åˆ’</label>
                    </div>
                </div>
                <div style="text-align: right; margin-top: 30px;">
                    <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                    <button class="btn btn-primary" onclick="downloadReport()">ç”ŸæˆPDFæŠ¥å‘Š</button>
                </div>
            `);
            document.body.appendChild(modal);
        }

        // å¯¼å‡ºé—®é¢˜æ¸…å•
        function exportIssueList() {
            const modal = createModal('å¯¼å‡ºé—®é¢˜æ¸…å•', `
                <div class="form-group">
                    <label class="form-label">å¯¼å‡ºèŒƒå›´</label>
                    <select class="form-control" id="exportScope">
                        <option value="all">å…¨éƒ¨é—®é¢˜</option>
                        <option value="A">Açº§é—®é¢˜</option>
                        <option value="B">Bçº§é—®é¢˜</option>
                        <option value="C">Cçº§é—®é¢˜</option>
                        <option value="pending">å¾…å¤„ç†é—®é¢˜</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">å¯¼å‡ºæ ¼å¼</label>
                    <select class="form-control" id="exportFormat">
                        <option value="excel">Excelæ–‡ä»¶</option>
                        <option value="csv">CSVæ–‡ä»¶</option>
                        <option value="pdf">PDFæ–‡ä»¶</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">åŒ…å«å­—æ®µ</label>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                        <label><input type="checkbox" checked> é—®é¢˜ç­‰çº§</label>
                        <label><input type="checkbox" checked> æ‰€å±åŒºåŸŸ</label>
                        <label><input type="checkbox" checked> é—®é¢˜æè¿°</label>
                        <label><input type="checkbox" checked> å¤„ç†çŠ¶æ€</label>
                        <label><input type="checkbox" checked> è´Ÿè´£äºº</label>
                        <label><input type="checkbox" checked> æˆªæ­¢æ—¥æœŸ</label>
                    </div>
                </div>
                <div style="text-align: right; margin-top: 30px;">
                    <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                    <button class="btn btn-success" onclick="downloadIssueList()">å¯¼å‡ºæ¸…å•</button>
                </div>
            `);
            document.body.appendChild(modal);
        }

        // é¢„è­¦é€šçŸ¥è®¾ç½®
        function setupAlertNotification() {
            const modal = createModal('é¢„è­¦é€šçŸ¥è®¾ç½®', `
                <div class="form-group">
                    <label class="form-label">è´¢åŠ¡é£é™©é¢„è­¦é˜ˆå€¼ï¼ˆä¸‡å…ƒï¼‰</label>
                    <input type="number" class="form-control" id="financialThreshold" value="${dashboardData.alertSettings.financialThreshold}">
                </div>
                <div class="form-group">
                    <label class="form-label">äººå‘˜æ±°æ¢ç‡é¢„è­¦é˜ˆå€¼ï¼ˆ%ï¼‰</label>
                    <input type="number" class="form-control" id="personnelThreshold" value="${dashboardData.alertSettings.personnelTurnoverThreshold}">
                </div>
                <div class="form-group">
                    <label class="form-label">åˆè§„é£é™©é¢„è­¦é˜ˆå€¼ï¼ˆä¸‡å…ƒï¼‰</label>
                    <input type="number" class="form-control" id="complianceThreshold" value="${dashboardData.alertSettings.complianceThreshold}">
                </div>
                <div class="form-group">
                    <label class="form-label">é€šçŸ¥æ–¹å¼</label>
                    <div>
                        <label><input type="checkbox" checked> ç³»ç»Ÿå†…é€šçŸ¥</label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">é€šçŸ¥å¯¹è±¡</label>
                    <div>
                        <label><input type="checkbox" checked> å½“å‰é¡µé¢ç”¨æˆ·</label>
                    </div>
                </div>
                <div style="text-align: right; margin-top: 30px;">
                    <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                    <button class="btn btn-primary" onclick="saveAlertSettings()">ä¿å­˜è®¾ç½®</button>
                </div>
            `);
            document.body.appendChild(modal);
        }

        // å·¡è§†è®¡åˆ’ç®¡ç†
        function manageInspectionPlan() {
            const modal = createModal('å·¡è§†è®¡åˆ’ç®¡ç†', `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3>å·¡è§†è®¡åˆ’åˆ—è¡¨</h3>
                    <button class="btn btn-primary" onclick="addNewPlan()">æ–°å¢è®¡åˆ’</button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>è®¡åˆ’åç§°</th>
                            <th>å¼€å§‹æ—¥æœŸ</th>
                            <th>ç»“æŸæ—¥æœŸ</th>
                            <th>è¿›åº¦</th>
                            <th>çŠ¶æ€</th>
                            <th>è´Ÿè´£äºº</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="planTableBody">
                        ${dashboardData.inspectionPlans.map(plan => `
                            <tr>
                                <td>${plan.name}</td>
                                <td>${plan.startDate}</td>
                                <td>${plan.endDate}</td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <div style="width: 100px; height: 8px; background: #e2e8f0; border-radius: 4px;">
                                            <div style="width: ${plan.progress}%; height: 100%; background: #28a745; border-radius: 4px;"></div>
                                        </div>
                                        <span>${plan.progress}%</span>
                                    </div>
                                </td>
                                <td>
                                    <span style="padding: 4px 8px; border-radius: 12px; font-size: 0.8rem; color: white; background: ${plan.status === 'å·²å®Œæˆ' ? '#28a745' : plan.status === 'è¿›è¡Œä¸­' ? '#fd7e14' : '#6c757d'};">
                                        ${plan.status}
                                    </span>
                                </td>
                                <td>${plan.responsible}</td>
                                <td>
                                    <button class="btn" style="padding: 4px 8px; font-size: 0.8rem; margin: 2px;" onclick="editPlan(${plan.id})">ç¼–è¾‘</button>
                                    <button class="btn" style="padding: 4px 8px; font-size: 0.8rem; margin: 2px; background: #dc3545;" onclick="deletePlan(${plan.id})">åˆ é™¤</button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
                <div class="gantt-chart">
                    <h4>ç”˜ç‰¹å›¾è§†å›¾</h4>
                    ${dashboardData.inspectionPlans.map(plan => `
                        <div class="gantt-item">
                            <div class="gantt-label">${plan.name}</div>
                            <div class="gantt-bar">
                                <div class="gantt-progress" style="width: ${plan.progress}%;"></div>
                            </div>
                            <div class="gantt-date">${plan.startDate} - ${plan.endDate}</div>
                        </div>
                    `).join('')}
                </div>
                <div style="text-align: right; margin-top: 30px;">
                    <button class="btn btn-secondary" onclick="closeModal()">å…³é—­</button>
                </div>
            `);
            document.body.appendChild(modal);
        }

        // æ•°æ®å¯¼å…¥åŠŸèƒ½
        function importData() {
            const modal = createModal('æ•°æ®å¯¼å…¥', `
                <div class="form-group">
                    <label class="form-label">é€‰æ‹©æ•°æ®æ¨¡æ¿</label>
                    <select class="form-control" id="dataTemplate">
                        <option value="personnel">äººå‘˜æ•°æ®æ¨¡æ¿</option>
                        <option value="finance">è´¢åŠ¡æ•°æ®æ¨¡æ¿</option>
                        <option value="compliance">åˆè§„æ•°æ®æ¨¡æ¿</option>
                        <option value="inspection">å·¡è§†æ•°æ®æ¨¡æ¿</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">ä¸‹è½½æ¨¡æ¿</label>
                    <button class="btn btn-primary" onclick="downloadTemplate()">ä¸‹è½½Excelæ¨¡æ¿</button>
                </div>
                <div class="form-group">
                    <label class="form-label">ä¸Šä¼ æ•°æ®æ–‡ä»¶</label>
                    <div class="file-upload" id="fileUpload" onclick="document.getElementById('fileInput').click()">
                        <div style="font-size: 1.2rem; margin-bottom: 10px;">ğŸ“</div>
                        <div>ç‚¹å‡»é€‰æ‹©æ–‡ä»¶æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„</div>
                        <div style="font-size: 0.9rem; color: #6c757d; margin-top: 5px;">æ”¯æŒ .xlsx, .xls, .csv æ ¼å¼</div>
                    </div>
                    <input type="file" id="fileInput" style="display: none;" accept=".xlsx,.xls,.csv" onchange="handleFileUpload(event)">
                </div>
                <div class="form-group" id="previewSection" style="display: none;">
                    <label class="form-label">æ•°æ®é¢„è§ˆ</label>
                    <div id="dataPreview" style="max-height: 300px; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 8px; padding: 15px;"></div>
                </div>
                <div style="text-align: right; margin-top: 30px;">
                    <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                    <button class="btn btn-success" id="importBtn" onclick="importDataFile()" style="display: none;">å¯¼å…¥æ•°æ®</button>
                </div>
            `);
            document.body.appendChild(modal);
        }

        // åˆ›å»ºæ¨¡æ€æ¡†
        function createModal(title, content) {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="modal-title">${title}</div>
                        <span class="close" onclick="closeModal()">&times;</span>
                    </div>
                    <div class="modal-body">
                        ${content}
                    </div>
                </div>
            `;
            return modal;
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal() {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => modal.remove());
        }

        // ä¸‹è½½æŠ¥å‘Š
        function downloadReport() {
            showNotification('æ­£åœ¨ç”ŸæˆPDFæŠ¥å‘Šï¼Œè¯·ç¨å€™...', 'info');
            setTimeout(() => {
                showNotification('PDFæŠ¥å‘Šç”ŸæˆæˆåŠŸï¼', 'success');
                closeModal();
            }, 2000);
        }

        // ä¸‹è½½é—®é¢˜æ¸…å•
        function downloadIssueList() {
            showNotification('æ­£åœ¨å¯¼å‡ºé—®é¢˜æ¸…å•...', 'info');
            setTimeout(() => {
                showNotification('é—®é¢˜æ¸…å•å¯¼å‡ºæˆåŠŸï¼', 'success');
                closeModal();
            }, 1500);
        }

        // ä¿å­˜é¢„è­¦è®¾ç½®
        function saveAlertSettings() {
            dashboardData.alertSettings.financialThreshold = document.getElementById('financialThreshold').value;
            dashboardData.alertSettings.personnelTurnoverThreshold = document.getElementById('personnelThreshold').value;
            dashboardData.alertSettings.complianceThreshold = document.getElementById('complianceThreshold').value;
            showNotification('é¢„è­¦è®¾ç½®ä¿å­˜æˆåŠŸï¼', 'success');
            closeModal();
        }

        // æ–°å¢è®¡åˆ’
        function addNewPlan() {
            const modal = createModal('æ–°å¢å·¡è§†è®¡åˆ’', `
                <div class="form-group">
                    <label class="form-label">è®¡åˆ’åç§°</label>
                    <input type="text" class="form-control" id="planName" placeholder="è¯·è¾“å…¥è®¡åˆ’åç§°">
                </div>
                <div class="form-group">
                    <label class="form-label">å¼€å§‹æ—¥æœŸ</label>
                    <input type="date" class="form-control" id="startDate">
                </div>
                <div class="form-group">
                    <label class="form-label">ç»“æŸæ—¥æœŸ</label>
                    <input type="date" class="form-control" id="endDate">
                </div>
                <div class="form-group">
                    <label class="form-label">è´Ÿè´£äºº</label>
                    <select class="form-control" id="responsible">
                        <option value="å¼ æ€»">å¼ æ€»</option>
                        <option value="ç‹æ€»">ç‹æ€»</option>
                        <option value="ææ€»">ææ€»</option>
                        <option value="é™ˆæ€»">é™ˆæ€»</option>
                    </select>
                </div>
                <div style="text-align: right; margin-top: 30px;">
                    <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                    <button class="btn btn-primary" onclick="saveNewPlan()">ä¿å­˜</button>
                </div>
            `);
            document.body.appendChild(modal);
        }

        // ä¿å­˜æ–°è®¡åˆ’
        function saveNewPlan() {
            const newPlan = {
                id: dashboardData.inspectionPlans.length + 1,
                name: document.getElementById('planName').value,
                startDate: document.getElementById('startDate').value,
                endDate: document.getElementById('endDate').value,
                progress: 0,
                status: 'æœªå¼€å§‹',
                responsible: document.getElementById('responsible').value
            };
            dashboardData.inspectionPlans.push(newPlan);
            showNotification('è®¡åˆ’æ·»åŠ æˆåŠŸï¼', 'success');
            closeModal();
        }

        // ç¼–è¾‘è®¡åˆ’
        function editPlan(id) {
            const plan = dashboardData.inspectionPlans.find(p => p.id === id);
            const modal = createModal('ç¼–è¾‘å·¡è§†è®¡åˆ’', `
                <div class="form-group">
                    <label class="form-label">è®¡åˆ’åç§°</label>
                    <input type="text" class="form-control" id="editPlanName" value="${plan.name}">
                </div>
                <div class="form-group">
                    <label class="form-label">å¼€å§‹æ—¥æœŸ</label>
                    <input type="date" class="form-control" id="editStartDate" value="${plan.startDate}">
                </div>
                <div class="form-group">
                    <label class="form-label">ç»“æŸæ—¥æœŸ</label>
                    <input type="date" class="form-control" id="editEndDate" value="${plan.endDate}">
                </div>
                <div class="form-group">
                    <label class="form-label">è¿›åº¦ï¼ˆ%ï¼‰</label>
                    <input type="number" class="form-control" id="editProgress" value="${plan.progress}" min="0" max="100">
                </div>
                <div class="form-group">
                    <label class="form-label">çŠ¶æ€</label>
                    <select class="form-control" id="editStatus">
                        <option value="æœªå¼€å§‹" ${plan.status === 'æœªå¼€å§‹' ? 'selected' : ''}>æœªå¼€å§‹</option>
                        <option value="è¿›è¡Œä¸­" ${plan.status === 'è¿›è¡Œä¸­' ? 'selected' : ''}>è¿›è¡Œä¸­</option>
                        <option value="å·²å®Œæˆ" ${plan.status === 'å·²å®Œæˆ' ? 'selected' : ''}>å·²å®Œæˆ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">è´Ÿè´£äºº</label>
                    <select class="form-control" id="editResponsible">
                        <option value="å¼ æ€»" ${plan.responsible === 'å¼ æ€»' ? 'selected' : ''}>å¼ æ€»</option>
                        <option value="ç‹æ€»" ${plan.responsible === 'ç‹æ€»' ? 'selected' : ''}>ç‹æ€»</option>
                        <option value="ææ€»" ${plan.responsible === 'ææ€»' ? 'selected' : ''}>ææ€»</option>
                        <option value="é™ˆæ€»" ${plan.responsible === 'é™ˆæ€»' ? 'selected' : ''}>é™ˆæ€»</option>
                    </select>
                </div>
                <div style="text-align: right; margin-top: 30px;">
                    <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                    <button class="btn btn-primary" onclick="saveEditPlan(${id})">ä¿å­˜</button>
                </div>
            `);
            document.body.appendChild(modal);
        }

        // ä¿å­˜ç¼–è¾‘è®¡åˆ’
        function saveEditPlan(id) {
            const plan = dashboardData.inspectionPlans.find(p => p.id === id);
            plan.name = document.getElementById('editPlanName').value;
            plan.startDate = document.getElementById('editStartDate').value;
            plan.endDate = document.getElementById('editEndDate').value;
            plan.progress = parseInt(document.getElementById('editProgress').value);
            plan.status = document.getElementById('editStatus').value;
            plan.responsible = document.getElementById('editResponsible').value;
            showNotification('è®¡åˆ’æ›´æ–°æˆåŠŸï¼', 'success');
            closeModal();
        }

        // åˆ é™¤è®¡åˆ’
        function deletePlan(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè®¡åˆ’å—ï¼Ÿ')) {
                dashboardData.inspectionPlans = dashboardData.inspectionPlans.filter(p => p.id !== id);
                showNotification('è®¡åˆ’åˆ é™¤æˆåŠŸï¼', 'success');
                closeModal();
            }
        }

        // ä¸‹è½½æ¨¡æ¿
        function downloadTemplate() {
            showNotification('æ­£åœ¨ä¸‹è½½æ¨¡æ¿æ–‡ä»¶...', 'info');
            setTimeout(() => {
                showNotification('æ¨¡æ¿ä¸‹è½½æˆåŠŸï¼', 'success');
            }, 1000);
        }

        // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file) {
                showNotification('æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œæ­£åœ¨è§£æ...', 'info');
                setTimeout(() => {
                    document.getElementById('previewSection').style.display = 'block';
                    document.getElementById('importBtn').style.display = 'inline-block';
                    document.getElementById('dataPreview').innerHTML = `
                        <div style="color: #28a745; font-weight: 600; margin-bottom: 10px;">âœ“ æ–‡ä»¶è§£ææˆåŠŸ</div>
                        <div>æ–‡ä»¶å: ${file.name}</div>
                        <div>æ–‡ä»¶å¤§å°: ${(file.size / 1024).toFixed(2)} KB</div>
                        <div>é¢„è®¡å¯¼å…¥: 25 æ¡æ•°æ®è®°å½•</div>
                    `;
                }, 1500);
            }
        }

        // å¯¼å…¥æ•°æ®æ–‡ä»¶
        function importDataFile() {
            showNotification('æ­£åœ¨å¯¼å…¥æ•°æ®...', 'info');
            setTimeout(() => {
                showNotification('æ•°æ®å¯¼å…¥æˆåŠŸï¼å…±å¯¼å…¥ 25 æ¡è®°å½•', 'success');
                closeModal();
            }, 2000);
        }

        // ç®€å•çš„äº¤äº’æ•ˆæœ
        document.addEventListener('DOMContentLoaded', function() {
            // æ·»åŠ å¡ç‰‡æ‚¬åœæ•ˆæœ
            const cards = document.querySelectorAll('.risk-card, .progress-stat');
            cards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-5px)';
                    this.style.boxShadow = '0 15px 35px rgba(0,0,0,0.15)';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                    this.style.boxShadow = '0 8px 32px rgba(0,0,0,0.1)';
                });
            });

            // å¿«é€Ÿæ“ä½œæŒ‰é’®ç‚¹å‡»æ•ˆæœ
            const actionBtns = document.querySelectorAll('.action-btn');
            actionBtns.forEach((btn, index) => {
                btn.addEventListener('click', function() {
                    // ç®€å•çš„ç‚¹å‡»åé¦ˆ
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 150);
                    
                    // æ ¹æ®æŒ‰é’®ç´¢å¼•è°ƒç”¨å¯¹åº”åŠŸèƒ½
                    const functions = [
                        generateMonthlyReport,
                        exportIssueList,
                        setupAlertNotification,
                        () => showNotification('å†å²è¶‹åŠ¿åŠŸèƒ½å¼€å‘ä¸­...', 'info'),
                        manageInspectionPlan
                    ];
                    
                    if (functions[index]) {
                        functions[index]();
                    }
                });
            });

            // è¡¨æ ¼è¡Œç‚¹å‡»æ•ˆæœ
            const tableRows = document.querySelectorAll('.heatmap-table tbody tr');
            tableRows.forEach(row => {
                row.addEventListener('click', function() {
                    // ç§»é™¤å…¶ä»–è¡Œçš„é€‰ä¸­çŠ¶æ€
                    tableRows.forEach(r => r.classList.remove('selected'));
                    // æ·»åŠ å½“å‰è¡Œçš„é€‰ä¸­çŠ¶æ€
                    this.classList.add('selected');
                });
            });

            // åŠ¨æ€æ›´æ–°æ—¶é—´
            function updateTime() {
                const now = new Date();
                const timeString = now.toLocaleString('zh-CN', {
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                const headerText = document.querySelector('.header-text p');
                if (headerText) {
                    headerText.textContent = `2025å¹´9æœˆ | ç»è¥æ€»å…¬å¸å·¡è§†ç»„ | æœ€åæ›´æ–°ï¼š${timeString}`;
                }
            }

            // æ¯åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡æ—¶é—´
            setInterval(updateTime, 60000);

            // æ·»åŠ æ•°æ®å¯¼å…¥æŒ‰é’®åˆ°å¤´éƒ¨
            const headerStatus = document.querySelector('.header-status');
            const importBtn = document.createElement('button');
            importBtn.className = 'btn btn-primary';
            importBtn.style.cssText = 'padding: 8px 16px; border: none; border-radius: 20px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; font-weight: bold; cursor: pointer;';
            importBtn.textContent = 'æ•°æ®å¯¼å…¥';
            importBtn.onclick = importData;
            headerStatus.appendChild(importBtn);
        });
    </script>
</body>
</html>
